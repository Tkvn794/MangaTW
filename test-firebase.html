<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç Firebase</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
</head>
<body>
    <h1>–¢–µ—Å—Ç Firebase Database</h1>
    <div id="status">–°—Ç–∞—Ç—É—Å: –ü—Ä–æ–≤–µ—Ä–∫–∞...</div>
    <div>
        <input type="text" id="test-message" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ">
        <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
    <div id="messages"></div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCfzfqOEXyO4f9w_WHfb5ba6VucR4C1h7Q",
            authDomain: "webrtc-chat-d4b03.firebaseapp.com",
            databaseURL: "https://webrtc-chat-d4b03-default-rtdb.firebaseio.com/",
            projectId: "webrtc-chat-d4b03",
            storageBucket: "webrtc-chat-d4b03.firebasestorage.app",
            messagingSenderId: "664462632968",
            appId: "1:664462632968:web:5908950ee288dde239c9bd"
        };

        try {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
            firebase.initializeApp(firebaseConfig);
            document.getElementById('status').innerHTML += '<br>‚úÖ Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω';
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
            const db = firebase.database();
            const testRef = db.ref('test_messages');
            
            document.getElementById('status').innerHTML += '<br>‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';
            
            // –°–ª—É—à–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            testRef.on('child_added', (snapshot) => {
                const data = snapshot.val();
                const messagesDiv = document.getElementById('messages');
                messagesDiv.innerHTML += `<div><strong>${data.sender}:</strong> ${data.text} <small>(${new Date(data.timestamp).toLocaleTimeString()})</small></div>`;
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
                document.getElementById('status').innerHTML += '<br>üì• –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ';
            });
            
            document.getElementById('status').innerHTML += '<br>‚úÖ –°–ª—É—à–∞—Ç–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';
            
        } catch (error) {
            document.getElementById('status').innerHTML += '<br>‚ùå –û—à–∏–±–∫–∞: ' + error.message;
            console.error('–û—à–∏–±–∫–∞ Firebase:', error);
        }
        
        function sendMessage() {
            try {
                const message = document.getElementById('test-message').value;
                if (!message.trim()) return;
                
                const db = firebase.database();
                const testRef = db.ref('test_messages');
                
                testRef.push({
                    text: message,
                    sender: '–¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    timestamp: Date.now()
                });
                
                document.getElementById('test-message').value = '';
                document.getElementById('status').innerHTML += '<br>üì§ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ';
                
            } catch (error) {
                document.getElementById('status').innerHTML += '<br>‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ' + error.message;
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
            }
        }
    </script>
</body>
</html>
